<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="AppPallet.Views.PresupuestoView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:fa="clr-namespace:UraniumUI.Icons.FontAwesome;assembly=UraniumUI.Icons.FontAwesome"
    xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
    xmlns:models="clr-namespace:AppPallet.Models"
    xmlns:uranium="http://schemas.enisn-projects.io/dotnet/maui/uraniumui"
    xmlns:viewModels="clr-namespace:AppPallet.ViewModels"
    Title="PresupuestoView"
    x:DataType="viewModels:PresupuestoViewModel"
    Shell.NavBarIsVisible="False">


    <Grid RowDefinitions="Auto,Auto,Auto">

        <Border
            Grid.Row="0"
            BackgroundColor="#374151"
            HeightRequest="60"
            Stroke="Black">
            <Grid ColumnDefinitions="0.3*,Auto,Auto,0.1*">

                <Label
                    Grid.Column="0"
                    Margin="10,0,0,0"
                    FontAttributes="Bold"
                    FontSize="25"
                    HorizontalOptions="Start"
                    Text="PRESUPUESTOS"
                    TextColor="#F6F1EB"
                    VerticalOptions="Center" />
                <Button
                    Grid.Column="2"
                    Padding="20,10"
                    BackgroundColor="#F6F1EB"
                    BorderColor="#D0B595"
                    BorderWidth="3"
                    Command="{Binding CrearPresupuestoCommand}"
                    CornerRadius="20"
                    HeightRequest="43"
                    HorizontalOptions="End"
                    StyleClass="FilledButton"
                    Text="Crear nuevo presupuesto"
                    TextColor="Black"
                    WidthRequest="200" />
            </Grid>
        </Border>



        <ScrollView Grid.Row="1">
            <FlexLayout
                BindableLayout.ItemsSource="{Binding ListaEmpresas}"
                Direction="Row"
                Wrap="Wrap">
                <BindableLayout.ItemTemplate>
                    <DataTemplate x:DataType="models:Empresa">
                        <Border
                            Margin="10"
                            HeightRequest="200"
                            WidthRequest="400">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12" />
                            </Border.StrokeShape>


                            <Grid RowDefinitions="Auto,*,30">
                                <!--  Parte superior con color pastel  -->
                                <BoxView BackgroundColor="#D0B595" HeightRequest="80" />

                                <!--  Parte inferior con texto  -->
                                <StackLayout Padding="10">
                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="16"
                                        Text="{Binding NomEmpresa}" />
                                    <Label FontSize="14" Text="{Binding Cuit}" />
                                </StackLayout>

                                <VerticalStackLayout Grid.Row="1" HorizontalOptions="Center">

                                    <Label
                                        Padding="0,5,0,0"
                                        FontAttributes="Bold"
                                        FontSize="15"
                                        HorizontalTextAlignment="Center"
                                        Text="Presupuesto de este mes:"
                                        TextColor="#A2A2A2" />

                                    <CollectionView
                                        Margin="20"
                                        HorizontalOptions="Center"
                                        ItemsSource="{Binding CostoPorPallet}">
                                        <CollectionView.ItemsLayout>
                                            <LinearItemsLayout Orientation="Vertical" />
                                        </CollectionView.ItemsLayout>
                                        <CollectionView.ItemTemplate>
                                            <DataTemplate x:DataType="models:CostoPorPallet">
                                                <HorizontalStackLayout Padding="0,0,0,5" Spacing="15">
                                                    <Label
                                                        FontSize="13"
                                                        Text="{Binding NombrePalletCliente}"
                                                        TextColor="#90894A" />
                                                    <HorizontalStackLayout>
                                                        <Label
                                                            Padding="0,0,5,0"
                                                            FontSize="13"
                                                            Text="Precio:" />
                                                        <Label FontSize="13" Text="$" />
                                                        <Label FontSize="13" Text="{Binding PrecioPallet}" />
                                                    </HorizontalStackLayout>
                                                    <HorizontalStackLayout>
                                                        <Label
                                                            Padding="0,0,5,0"
                                                            FontSize="13"
                                                            Text="Ganancia:" />
                                                        <Label FontSize="13" Text="$" />
                                                        <Label FontSize="13" Text="{Binding GananciaPorCantPallet}" />
                                                    </HorizontalStackLayout>
                                                </HorizontalStackLayout>
                                            </DataTemplate>
                                        </CollectionView.ItemTemplate>
                                    </CollectionView>
                                </VerticalStackLayout>


                                <Button
                                    Grid.Row="2"
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:PresupuestoViewModel}}, Path=MostrarPresupuestoCommand}"
                                    CommandParameter="{Binding EmpresaId}"
                                    HorizontalOptions="End"
                                    StyleClass="TextButton"
                                    Text="Ver"
                                    TextColor="#D0B595" />



                            </Grid>




                        </Border>
                    </DataTemplate>
                </BindableLayout.ItemTemplate>
            </FlexLayout>


        </ScrollView>
    </Grid>



</ContentPage>